<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Fantasy Draft Tracker</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <style>
    body { background:#121212; color:#eee; }
    .navbar { margin-bottom:1rem; }
    .card { background:#1e1e1e; color:#eee; }
    .muted { font-size:0.85em; color:#aaa; }
    .money { font-weight:bold; }
    .drafted { opacity:0.5; text-decoration:line-through; }
    .band.high { background:#28a745; color:#fff; padding:2px 6px; border-radius:4px; margin-right:4px;}
    .band.medium { background:#ffc107; color:#000; padding:2px 6px; border-radius:4px; margin-right:4px;}
    .band.low { background:#fd7e14; color:#fff; padding:2px 6px; border-radius:4px; margin-right:4px;}
    .band.other { background:#6c757d; color:#fff; padding:2px 6px; border-radius:4px; margin-right:4px;}
    .collapsible-header { cursor:pointer; background:#222; padding:8px; font-weight:bold; }
  </style>
</head>
<body>
  <nav class="navbar navbar-dark bg-dark">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">Fantasy Draft Tracker</a>
      <div>
        <a href="#" id="nav-draft" class="btn btn-sm btn-outline-light">Draft</a>
        <a href="#" id="nav-managers" class="btn btn-sm btn-outline-light">Managers</a>
        <a href="#" id="nav-settings" class="btn btn-sm btn-outline-light">Settings</a>
      </div>
    </div>
  </nav>

  <div class="container" id="app"></div>

  <script>
    const e = React.createElement;

    // Dummy players until CSV is loaded
    let currentPlayers = [
      {name:"Ja'Marr Chase", team:"CIN", pos:"WR", rank:1, bye:10},
      {name:"Bijan Robinson", team:"ATL", pos:"RB", rank:2, bye:5},
      {name:"Patrick Mahomes", team:"KC", pos:"QB", rank:1, bye:6}
    ];

    let drafted = [];
    let managers = ["Me","Alice","Bob","Carol"];

    function rankBand(rank){
      if(!rank) return "other";
      if(rank<=10) return "high";
      if(rank<=20) return "medium";
      if(rank<=30) return "low";
      return "other";
    }

    function quickDraft(player, cost, mgr){
      drafted.push({...player,cost,manager:mgr,ts:Date.now()});
      // Grey out instead of remove
      const idx = currentPlayers.findIndex(p=>p.name===player.name);
      if(idx!==-1){
        currentPlayers[idx].draftedBy=mgr;
        currentPlayers[idx].draftCost=cost;
      }
      render();
    }

    function DraftPage(){
      return e('div',null,
        e('h3',null,'Draft Board'),
        e('div',{className:'row'},
          currentPlayers.map(p=>{
            const drafted = p.draftedBy;
            return e('div',{key:p.name,className:'col-md-4 mb-3'},
              e('div',{className:`card p-2 ${drafted?'drafted':''}`},
                e('h5',null,
                  e('span',{className:`band ${rankBand(p.rank)}`},'#'+p.rank),
                  p.name
                ),
                e('div',{className:'muted'},`${p.pos} â€¢ Bye ${p.bye}`),
                drafted
                  ? e('div',{className:'muted'},`Drafted by ${p.draftedBy} for $${p.draftCost}`)
                  : e('div',{className:'d-flex'},
                      e('input',{type:'number',min:0.5,step:0.5,placeholder:'$',
                        className:'form-control form-control-sm me-1',
                        id:'bid-'+p.name}),
                      e('select',{className:'form-select form-select-sm me-1',id:'mgr-'+p.name},
                        managers.map(m=>e('option',{key:m},m))
                      ),
                      e('button',{className:'btn btn-sm btn-success',
                        onClick:()=>{
                          const val=parseFloat(document.getElementById('bid-'+p.name).value);
                          const mgr=document.getElementById('mgr-'+p.name).value;
                          if(val && mgr) quickDraft(p,val,mgr);
                        }},'Draft')
                    )
              )
            );
          })
        ),
        e(LastDrafted)
      );
    }

    function LastDrafted(){
      const [view,setView]=React.useState('collapsed');
      if(view==='collapsed'){
        return e('div',null,
          e('div',{className:'collapsible-header',onClick:()=>setView('last3')},'Last Drafted (click to expand)')
        );
      }
      let list=drafted;
      if(view==='last3') list=drafted.slice(-3).reverse();
      if(view==='last10') list=drafted.slice(-10).reverse();
      if(view==='all') list=[...drafted].reverse();
      return e('div',{className:'mt-3'},
        e('div',{className:'btn-group mb-2'},
          e('button',{className:'btn btn-sm btn-outline-light',onClick:()=>setView('last3')},'Last 3'),
          e('button',{className:'btn btn-sm btn-outline-light',onClick:()=>setView('last10')},'Last 10'),
          e('button',{className:'btn btn-sm btn-outline-light',onClick:()=>setView('all')},'All'),
          e('button',{className:'btn btn-sm btn-outline-light',onClick:()=>setView('collapsed')},'Collapse')
        ),
        e('ul',{className:'list-group'},
          list.map(p=>
            e('li',{key:p.ts,className:'list-group-item bg-dark text-light d-flex justify-content-between'},
              e('span',null,
                e('span',{className:`band ${rankBand(p.rank)}`},'#'+p.rank+' '),
                p.name,' (',p.pos,')'
              ),
              e('span',null,`${p.manager} - $${p.cost}`)
            )
          )
        )
      );
    }

    function ManagersPage(){
      return e('div',null,
        e('h3',null,'Managers Overview'),
        e('table',{className:'table table-dark table-striped'},
          e('thead',null,
            e('tr',null,
              e('th',null,'Manager'),
              e('th',null,'Players'),
              e('th',null,'Spent')
            )
          ),
          e('tbody',null,
            managers.map(m=>{
              const myp=drafted.filter(p=>p.manager===m);
              const spent=myp.reduce((a,c)=>a+(c.cost||0),0);
              return e('tr',{key:m}, e('td',null,m), e('td',null,myp.length), e('td',null,'$'+spent));
            })
          )
        )
      );
    }

    function SettingsPage(){
      return e('div',null,
        e('h3',null,'Settings'),
        e('p',null,'(Upload CSVs, configure roster size, etc. placeholder)')
      );
    }

    function App(){
      const [page,setPage]=React.useState('draft');
      React.useEffect(()=>{
        document.getElementById('nav-draft').onclick=()=>setPage('draft');
        document.getElementById('nav-managers').onclick=()=>setPage('managers');
        document.getElementById('nav-settings').onclick=()=>setPage('settings');
      },[]);
      if(page==='draft') return e(DraftPage);
      if(page==='managers') return e(ManagersPage);
      if(page==='settings') return e(SettingsPage);
    }

    ReactDOM.render(e(App),document.getElementById('app'));
  </script>

  <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
</body>
</html>
